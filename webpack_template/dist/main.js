(()=>{"use strict";jQuery(document).ready(function(r){let n=r("#firstName"),s=r("#lastName"),a=r("#dateOfBirth"),t=r("#email"),o=r("#phoneNumber"),e=r("#policy"),i=r("#receiveEmail");const l=".form-submit__group",c=".form-submit__error span";function u(e){e.is(":checked")?e.parents(l).removeClass("has-error"):e.parents(l).addClass("has-error"),e.is(":checked")}function d(e){if(e.parents(l).find(".errorMsg__1").show(),e.val()&&1<Number(e.val().length)){if(!function(n){var s=n.length;for(let e=1;e<s;e++)if(n[e]!=n[0])return;return 1}(e.val()))return e.parents(l).removeClass("has-error"),1;e.parents(l).find("span").hide(),e.parents(l).find(".errorMsg__2").show(),e.parents(l).addClass("has-error")}else e.parents(l).find(".errorMsg__1").show(),e.parents(l).addClass("has-error")}function p(e){var n=/\S+@\S+\.\S+/.test(e.val());return e.val()&&n?e.parents(l).removeClass("has-error"):e.val()?t.parents(l).addClass("has-error").find(c).text("Email không đúng định dạng"):e.parents(l).addClass("has-error").find(c).text("Vui lòng nhập email"),n}function g(e){var n=/(((0|1)[0-9]|2[0-9]|3[0-1])\/(0[1-9]|1[0-2])\/((19|20)\d\d))$/.test(e.val());return e.val()&&n?e.parents(l).removeClass("has-error"):e.val()?e.parents(l).addClass("has-error").find(c).text("Ngày sinh không đúng định dạng"):e.parents(l).addClass("has-error").find(c).text("Vui lòng nhập ngày sinh"),n}function h(e){let n=e.val();if(n){if(!(n.length<=9))return"0"===n.substring(0,1)?n=n.substring(1,n.length):"84"===(n="840"===n.substring(0,3)?n.substring(3,n.length):n).substring(0,2)&&(n=n.substring(2,n.length)),e.parents(l).removeClass("has-error"),e.val("84"+n),1;e.parents(l).addClass("has-error").find(c).text("Số điện thoại không đúng định dạng")}else e.parents(l).addClass("has-error").find(c).text("Vui lòng nhập số điện thoại")}r("#reCaptchaV2, #jsSubmit").data("sitekey","6Lealo4gAAAAABbhvQqHjXlINIDAg2WLdc8pgQer"),n.alphanum({allowSpace:!0,allowUpper:!0,allowNumeric:!1,allowOtherCharSets:!0}),n.alphanum({allowSpace:!0,allowUpper:!0,allowNumeric:!1,allowOtherCharSets:!0}),n.on("focusout",function(){d(n)}),s.on("focusout",function(){d(s)}),t.on("focusout",function(){p(t)}),a.on("focusout",function(){g(a)}),a.keyup(function(){a.mask("00/00/0000")}),o.on("focusout",function(){h(o)}),e.on("change",function(){u(e)}),i.on("change",function(){u(i)}),r("#jsSubmit").click(function(e){e.preventDefault();var e=function(){let e=0;return d(n)||e++,d(s)||e++,p(t)||e++,g(a)||e++,h(o)||e++,console.log(e),e}();window.location.href;0<e||(r("#jsSubmit").addClass("loading").prop("disabled",!0),0<(e=grecaptcha.getResponse()).length?(r("#jsSubmit").addClass("loading").prop("disabled",!0),r(".recaptcha-message").slideUp(),r.ajax({url:"https://vn-2022-da-gcdm-registration-campaign-11447-stg.azurewebsites.net/api/User/insertUser",method:"POST",headers:{"content-type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST, GET, OPTIONS","Access-Control-Allow-Headers":"*"},data:JSON.stringify({FormCode:"da_gcdm_registration",lastName:s.val(),firstName:n.val(),email:t.val(),phoneNumber:o.val(),gender:"",dateOfBirth:a.val(),url:window.location.href,medium:window.location.search.replace("?",""),gRecaptchaResponse:e}),success:function(e,n,s){if(console.log(e),console.log(s),200==s.status){e="";if(r("#jsSubmit").removeClass("loading").prop("disabled",!1),"success"==s.responseJSON)return r("#popupSuccess").fadeIn(),document.getElementById("register").reset(),void general_tag();"invalidToken"!=s.responseJSON&&"invalidData"!=s.responseJSON||(e="Có lỗi xảy ra, vui lòng thử lại!"),"duplicateEmail"==s.responseJSON&&(e="Email này đã được sử dụng, vui lòng kiểm tra lại thông tin!"),"duplicatePhone"==s.responseJSON&&(e="Số điện thoại này đã được sử dụng, vui lòng kiểm tra lại thông tin!"),Swal.fire({icon:"error",text:e,confirmButtonText:"Đồng ý"})}},error:function(e,n,s){Swal.fire({icon:"error",text:"Có lỗi xảy ra, vui lòng thử lại!",confirmButtonText:"Đồng ý"}),r("#jsSubmit").removeClass("loading").prop("disabled",!1)}})):r(".recaptcha-message").slideDown())}),r("#popupSuccess .close-button, #popupSuccess .dimmer, #popupSuccess .cta--close-pu").on("click",function(e){e.preventDefault(),r("#popupSuccess").fadeOut()})})})();