(()=>{"use strict";jQuery(document).ready(function(s){let n=s("#firstName"),a=s("#lastName"),t=s("#dateOfBirth"),r=s("#email"),o=s("#phoneNumber"),e=s("#policy"),i=s("#receiveEmail");const l=".form-submit__group",c=".form-submit__error span";var u=-1!=window.location.href.indexOf("p6-qa");const d=`${u?"https://p6-qa.samsung.com":"https://www.samsung.com"}/aemapi/v6/mysamsung/info?siteCode=vn`;function p(e){e.is(":checked")?e.parents(l).removeClass("has-error"):e.parents(l).addClass("has-error"),e.is(":checked")}function g(e){if(e.parents(l).find(".errorMsg__1").show(),e.val()&&1<Number(e.val().length)){if(!function(n){var a=n.length;for(let e=1;e<a;e++)if(n[e]!=n[0])return;return 1}(e.val()))return e.parents(l).removeClass("has-error"),1;e.parents(l).find("span").hide(),e.parents(l).find(".errorMsg__2").show(),e.parents(l).addClass("has-error")}else e.parents(l).find(".errorMsg__1").show(),e.parents(l).addClass("has-error")}function m(e){var n=/\S+@\S+\.\S+/.test(e.val());return e.val()&&n?e.parents(l).removeClass("has-error"):e.val()?r.parents(l).addClass("has-error").find(c).text("Email không đúng định dạng"):e.parents(l).addClass("has-error").find(c).text("Vui lòng nhập email"),n}function h(e){var n=/(((0|1)[0-9]|2[0-9]|3[0-1])\/(0[1-9]|1[0-2])\/((19|20)\d\d))$/.test(e.val());return e.val()&&n?e.parents(l).removeClass("has-error"):e.val()?e.parents(l).addClass("has-error").find(c).text("Ngày sinh không đúng định dạng"):e.parents(l).addClass("has-error").find(c).text("Vui lòng nhập ngày sinh"),n}function f(e){let n=e.val();if(n){if(!(n.length<=9))return"0"===n.substring(0,1)?n=n.substring(1,n.length):"84"===(n="840"===n.substring(0,3)?n.substring(3,n.length):n).substring(0,2)&&(n=n.substring(2,n.length)),e.parents(l).removeClass("has-error"),e.val("84"+n),1;e.parents(l).addClass("has-error").find(c).text("Số điện thoại không đúng định dạng")}else e.parents(l).addClass("has-error").find(c).text("Vui lòng nhập số điện thoại")}s("#reCaptchaV2, #jsSubmit").data("sitekey","6Lealo4gAAAAABbhvQqHjXlINIDAg2WLdc8pgQer"),async function(){s.getJSON(d,function(e){console.log(e),e.resultData.mySamsung.basicInfo.email&&(n.val(decodeURIComponent(e.resultData.mySamsung.basicInfo.givenName)),a.val(decodeURIComponent(e.resultData.mySamsung.basicInfo.familyName)),r.val(e.resultData.mySamsung.basicInfo.email))}).always(function(){})}(),n.alphanum({allowSpace:!0,allowUpper:!0,allowNumeric:!1,allowOtherCharSets:!0}),a.alphanum({allowSpace:!0,allowUpper:!0,allowNumeric:!1,allowOtherCharSets:!0}),n.on("focusout",function(){g(n)}),a.on("focusout",function(){g(a)}),r.on("focusout",function(){m(r)}),t.on("focusout",function(){h(t)}),t.keyup(function(){t.mask("00/00/0000")}),o.on("focusout",function(){f(o)}),e.on("change",function(){p(e)}),i.on("change",function(){p(i)}),s("#jsSubmit").click(function(e){e.preventDefault();var e=function(){let e=0;return g(n)||e++,g(a)||e++,m(r)||e++,h(t)||e++,f(o)||e++,console.log(e),e}();window.location.href;0<e||(s("#jsSubmit").addClass("loading").prop("disabled",!0),0<(e=grecaptcha.getResponse()).length?(s("#jsSubmit").addClass("loading").prop("disabled",!0),s(".recaptcha-message").slideUp(),s.ajax({url:"https://vn-2022-da-gcdm-registration-campaign-11447-stg.azurewebsites.net/api/User/insertUser",method:"POST",headers:{"content-type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST, GET, OPTIONS","Access-Control-Allow-Headers":"*"},data:JSON.stringify({FormCode:"da_gcdm_registration",lastName:a.val(),firstName:n.val(),email:r.val(),phoneNumber:o.val(),gender:"",dateOfBirth:t.val(),url:window.location.href,medium:window.location.search.replace("?",""),gRecaptchaResponse:e}),success:function(e,n,a){if(console.log(e),console.log(a),200==a.status){e="";if(s("#jsSubmit").removeClass("loading").prop("disabled",!1),"success"==a.responseJSON)return s("#popupSuccess").fadeIn(),document.getElementById("register").reset(),void general_tag();"invalidToken"!=a.responseJSON&&"invalidData"!=a.responseJSON||(e="Có lỗi xảy ra, vui lòng thử lại!"),"duplicateEmail"==a.responseJSON&&(e="Email này đã được sử dụng, vui lòng kiểm tra lại thông tin!"),"duplicatePhone"==a.responseJSON&&(e="Số điện thoại này đã được sử dụng, vui lòng kiểm tra lại thông tin!"),Swal.fire({icon:"error",text:e,confirmButtonText:"Đồng ý"})}},error:function(e,n,a){Swal.fire({icon:"error",text:"Có lỗi xảy ra, vui lòng thử lại!",confirmButtonText:"Đồng ý"}),s("#jsSubmit").removeClass("loading").prop("disabled",!1)}})):s(".recaptcha-message").slideDown())}),s("#popupSuccess .close-button, #popupSuccess .dimmer, #popupSuccess .cta--close-pu").on("click",function(e){e.preventDefault(),s("#popupSuccess").fadeOut()})})})();