(() => { "use strict"; jQuery(document).ready(function (a) { let s = a("#firstName"), n = a("#lastName"), t = a("#dateOfBirth"), o = a("#email"), i = a("#phoneNumber"); const l = ".form-submit__group"; function d(e) { return /\S+@\S+\.\S+/.test(e) } function p(e) { return /(((0|1)[0-9]|2[0-9]|3[0-1])\/(0[1-9]|1[0-2])\/((19|20)\d\d))$/.test(e) } s.on("focusout", function () { s.val() ? s.parents(l).removeClass("has-error") : s.parents(l).addClass("has-error") }), n.on("focusout", function () { n.val() ? n.parents(l).removeClass("has-error") : n.parents(l).addClass("has-error") }), o.on("focusout", function () { o.val() ? 0 == d(o.val()) ? o.parents(l).addClass("has-error").find(".form-submit__error span").text("Email không đúng định dạng") : o.parents(l).removeClass("has-error") : o.parents(l).addClass("has-error").find(".form-submit__error span").text("Vui lòng nhập email") }), t.on("focusout", function () { t.val() ? p(t.val()) ? t.parents(l).removeClass("has-error") : t.parents(l).addClass("has-error").find(".form-submit__error span").text("Ngày sinh không đúng định dạng") : t.parents(l).addClass("has-error").find(".form-submit__error span").text("Vui lòng nhập ngày sinh") }), $("#dateOfBirth").keyup(function () { a("#dateOfBirth").mask("00/00/0000") }), i.on("focusout", function () { this.value.length; let e = i.val(), r = e.substring(0, 1), s = e.substring(0, 3); i.val() ? (i.val(), "0" === r ? e = e.substring(1, e.length) : "84" === (e = "840" === s ? e.substring(3, e.length) : e).substring(0, 2) && (e = e.substring(2, e.length)), i.val("84" + e), i.val() ? i.parents(l).removeClass("has-error") : i.parents(l).addClass("has-error").find(".form-submit__error span").text("Số điện thoại không đúng định dạng")) : i.parents(l).addClass("has-error").find(".form-submit__error span").text("Vui lòng nhập số điện thoại") }), a("#policy").on("change", function () { a("#policy").is(":checked") ? a("#policy").parents(l).removeClass("has-error") : a("#policy").parents(l).addClass("has-error") }), a("#receiveEmail").on("change", function () { a("#receiveEmail").is(":checked") ? a("#receiveEmail").parents(l).removeClass("has-error") : a("#receiveEmail").parents(l).addClass("has-error") }), a("#jsSubmit").click(function (e) { e.preventDefault(), a("#jsSubmit").addClass("loading").prop("disabled", !0); var r, e = 0; window.location.href; s.val() ? s.parents(l).removeClass("has-error") : (s.parents(l).addClass("has-error"), e++), n.val() ? n.parents(l).removeClass("has-error") : (n.parents(l).addClass("has-error"), e++), a("#policy").is(":checked") ? a("#policy").parents(l).removeClass("has-error") : (a("#policy").parents(l).addClass("has-error"), e++), a("#receiveEmail").is(":checked") ? a("#receiveEmail").parents(l).removeClass("has-error") : (a("#receiveEmail").parents(l).addClass("has-error"), e++), o.val() ? 0 == d(o.val()) ? (o.parents(l).addClass("has-error").find(".form-submit__error span").text("Email không đúng định dạng"), e++) : o.parents(l).removeClass("has-error") : (o.parents(l).addClass("has-error").find(".form-submit__error span").text("Vui lòng nhập email"), e++), t.val() ? p(t.val()) ? t.parents(l).removeClass("has-error") : (t.parents(l).addClass("has-error").find(".form-submit__error span").text("Ngày sinh không đúng định dạng"), e++) : (t.parents(l).addClass("has-error").find(".form-submit__error span").text("Vui lòng nhập ngày sinh"), e++), i.val() ? (i.val(), i.parents(l).removeClass("has-error")) : (i.parents(l).addClass("has-error").find(".form-submit__error span").text("Vui lòng nhập số điện thoại"), e++), t.val() || (p(r = t.val()) || 0 == r.length ? (t.parents(l).addClass("has-error"), e++) : t.parents(l).removeClass("has-error")), e <= 0 ? grecaptcha.ready(function () { grecaptcha.execute("6LdLz68eAAAAADOlXfLzagjvW9-qsRstASBEriI-", { action: "submit" }).then(function (e) { e = { FormCode: "da_gcdm_registration", FirstName: a("#firstName").val(), LastName: a("#lastName").val(), BirthDay: a("#dateOfBirth").val(), Email: a("#email").val(), phoneNumber: a("#phoneNumber").val(), ReferrerUrl: window.location.href, grecaptchaToken: e, gender: "", formCode: "default", product: a("#productName").val(), priceRange: a("#productRange").val(), medium: window.location.search.replace("?", "") }, (new Date).toISOString().split(".")[0], window.location.href, $.ajax({ url: "https://vn-2022-da-gcdm-registration-campaign-11447-stg.azurewebsites.net/api/User/insertUser", method: "POST", timeout: 5e3, headers: { "content-type": "application/json", "Access-Control-Allow-Origin": "*", "Access-Control-Allow-Methods": "POST, GET, OPTIONS", "Access-Control-Allow-Headers": "*" }, data: JSON.stringify({ FormCode: e.FormCode, lastName: e.LastName, firstName: e.FirstName, email: e.Email, phoneNumber: e.phoneNumber, gender: e.gender, dateOfBirth: e.BirthDay, url: e.ReferrerUrl, medium: e.medium, gRecaptchaResponse: e.grecaptchaToken, product: e.product, priceRange: e.priceRange }), success: function (e, r, s) { if (console.log(e), console.log(s), 200 == s.status) { e = ""; if ($("#jsSubmit").removeClass("loading").prop("disabled", !1), "success" == s.responseJSON) return $("#popupSuccess").fadeIn(), document.getElementById("register").reset(), void general_tag(); "invalidToken" != s.responseJSON && "invalidData" != s.responseJSON || (e = "Có lỗi xảy ra, vui lòng thử lại!"), "duplicateEmail" == s.responseJSON && (e = "Email này đã được sử dụng, vui lòng kiểm tra lại thông tin!"), "duplicatePhone" == s.responseJSON && (e = "Số điện thoại này đã được sử dụng, vui lòng kiểm tra lại thông tin!"), Swal.fire({ icon: "error", text: e, confirmButtonText: "Đồng ý" }) } }, error: function (e, r, s) { Swal.fire({ icon: "error", text: "Có lỗi xảy ra, vui lòng thử lại!", confirmButtonText: "Đồng ý" }), a("#jsSubmit").removeClass("loading").prop("disabled", !1) } }) }) }) : a("#jsSubmit").remove("loading").prop("disabled", !1) }), a("#popupSuccess .close-button, #popupSuccess .dimmer, #popupSuccess .cta--close-pu").on("click", function (e) { e.preventDefault(), a("#popupSuccess").fadeOut() }) }) })();